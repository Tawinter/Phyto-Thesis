faithful
library(maps)
require(maps)
map('state')
x(1:12)
x[1:12]
x=(1:12)
save.image("C:/Users/twint/OneDrive - University of New Hampshire/Intro to R/Trialworkspace.RData")
getwd()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
data(mpg)   # Car fuel economy data
head(mpg)   ##  head   gives the first 6 lines of the data
tail(mpg)   ##  tail   gives the last 6 lines of the data
dim(mpg)
# What is fl?
table(mpg$fl)
# Highway Miles per gallon
hist(mpg$hwy)
# Highway Miles per gallon
hist(mpg$hwy)
##  better;  use "with", then graph annotations are nicer
par(mfrow=c(1,2))
with(mpg,hist(hwy))
# Write a nice title
with(mpg,hist(hwy,main="Highway Fuel Efficiency in miles/gal ",cex.main = .7,xlab="highway mpg"))
table(mpg$fl)
# Highway Miles per gallon
hist(mpg$hwy)
##  better;  use "with", then graph annotations are nicer
par(mfrow=c(1,2))
with(mpg,hist(hwy))
# Write a nice title
with(mpg,hist(hwy,main="Highway Fuel Efficiency in miles/gal ",cex.main = .7,xlab="highway mpg"))
# Examine data :  categorical Variable 'year'
table(mpg$year)   #  frequency table of categorical variable
barplot(table(mpg$year))
title(" frequency of year")
# Scatterplot:  City versus Highway Mileage
with(mpg,plot(cty,hwy))
# a better way with nicer labels
plot(hwy ~ cty, data = mpg)
title("fuel efficiency in miles/gal",cex=.8)
#  Boxplot
boxplot(mpg$hwy,main = "highway mileage")
---
title: "Graphs in R"
author: "Ernst Linder"
date: "2019"
output: word_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### Packages
In this presentation we are using the packages:
'MASS', 'ggplot2', 'lubridate', and 'scales'.
Please first install 'ggplot2' and 'lubridate'.  'MASS' is installed automatically with the base installation of R. 'scales' may be installed with 'ggplot2' (not sure).
### Exploring what's in a Data Set
We use the Car fuel economy data from U.S. EPA available in the  package ggplot2
*What are the variables ?*  (Use  'head' and 'tail')
*What are the dimensions ?*
```{r  Exploring Data }
library(ggplot2)
data(mpg)   # Car fuel economy data
head(mpg)   ##  head   gives the first 6 lines of the data
tail(mpg)   ##  tail   gives the last 6 lines of the data
dim(mpg)
```
### Summarizing with Tables and Graphs
* What is fl?
* Examine hwy  (highway mileage)
* Histogram
* Frequency Table / Bar Graphs
* Scatterplot
* Boxplot,  Conditioning Plot
```{r Summarizing and Graphing Part 1 }
# What is fl?
table(mpg$fl)
# Highway Miles per gallon
hist(mpg$hwy)
##  better;  use "with", then graph annotations are nicer
par(mfrow=c(1,2))
with(mpg,hist(hwy))
# Write a nice title
with(mpg,hist(hwy,main="Highway Fuel Efficiency in miles/gal ",cex.main = .7,xlab="highway mpg"))
# Examine data :  categorical Variable 'year'
table(mpg$year)   #  frequency table of categorical variable
barplot(table(mpg$year))
title(" frequency of year")
# Scatterplot:  City versus Highway Mileage
with(mpg,plot(cty,hwy))
# a better way with nicer labels
plot(hwy ~ cty, data = mpg)
title("fuel efficiency in miles/gal",cex=.8)
#  Boxplot
boxplot(mpg$hwy,main = "highway mileage")
# Conditioning on a categorical variable:
plot(hwy~year,data = mpg)  # gives dotplot,  many dots stacked invisibly!
# Change year to categorical i.e. factor
mpg$year = as.factor(mpg$year)
plot(hwy~year,data = mpg)      #  same as this:
boxplot(hwy~year,data = mpg)  #  better
```
# Highway Miles per gallon
hist(mpg$hwy)
##  better;  use "with", then graph annotations are nicer
attach(mpg)
hist(hwy)
hist(mpg$hwy, main="highway fuel efficiency in miles/gal", xlab="highway mpg")
# What is fl?
table(mpg$fl)
# Highway Miles per gallon
hist(mpg$hwy)
##  better;  use "with", then graph annotations are nicer
attach(mpg)
hist(hwy)
detach(mpg)
par(mfrow=c(1,2))
with(mpg,hist(hwy))
# Write a nice title
with(mpg,hist(hwy,main="Highway Fuel Efficiency in miles/gal ",cex.main = .7,xlab="highway mpg"))
---
title: "Graphs in R"
author: "Ernst Linder"
date: "2019"
output: word_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### Packages
In this presentation we are using the packages:
'MASS', 'ggplot2', 'lubridate', and 'scales'.
Please first install 'ggplot2' and 'lubridate'.  'MASS' is installed automatically with the base installation of R. 'scales' may be installed with 'ggplot2' (not sure).
### Exploring what's in a Data Set
We use the Car fuel economy data from U.S. EPA available in the  package ggplot2
*What are the variables ?*  (Use  'head' and 'tail')
*What are the dimensions ?*
```{r  Exploring Data }
library(ggplot2)
data(mpg)   # Car fuel economy data
head(mpg)   ##  head   gives the first 6 lines of the data
tail(mpg)   ##  tail   gives the last 6 lines of the data
dim(mpg)
```
### Summarizing with Tables and Graphs
* What is fl?
* Examine hwy  (highway mileage)
* Histogram
* Frequency Table / Bar Graphs
* Scatterplot
* Boxplot,  Conditioning Plot
```{r Summarizing and Graphing Part 1 }
# What is fl?
table(mpg$fl)
# Highway Miles per gallon
hist(mpg$hwy)
##  better;  use "with", then graph annotations are nicer
attach(mpg)
hist(hwy)
detach(mpg)
par(mfrow=c(1,2))
with(mpg,hist(hwy))
# Write a nice title
with(mpg,hist(hwy,main="Highway Fuel Efficiency in miles/gal ",cex.main = .7,xlab="highway mpg"))
hist(mpg$hwy, main="highway fuel efficiency in miles/gal", xlab="highway mpg")
# Examine data :  categorical Variable 'year'
table(mpg$year)   #  frequency table of categorical variable
barplot(table(mpg$year))
title(" frequency of year")
# Scatterplot:  City versus Highway Mileage
with(mpg,plot(cty,hwy))
# a better way with nicer labels
plot(hwy ~ cty, data = mpg)
title("fuel efficiency in miles/gal",cex=.8)
#  Boxplot
boxplot(mpg$hwy,main = "highway mileage")
# Conditioning on a categorical variable:
plot(hwy~year,data = mpg)  # gives dotplot,  many dots stacked invisibly!
# Change year to categorical i.e. factor
mpg$year = as.factor(mpg$year)
plot(hwy~year,data = mpg)      #  same as this:
boxplot(hwy~year,data = mpg)  #  better
```
#  Boxplot
boxplot(mpg$hwy,main = "highway mileage")
boxplot(hwy~year,data = mpg)  #  better
#  Boxplot
boxplot(mpg$hwy,main = "highway mileage")
Boxplot
# Examine data :  categorical Variable 'year'
table(mpg$year)   #  frequency table of categorical variable
barplot(table(mpg$year))
title(" frequency of year")
# Scatterplot:  City versus Highway Mileage
with(mpg,plot(cty,hwy))
# a better way with nicer labels
plot(hwy ~ cty, data = mpg)
title("fuel efficiency in miles/gal",cex=.8)
#  Boxplot
boxplot(mpg$hwy,main = "highway mileage")
# Conditioning on a categorical variable:
plot(hwy~year,data = mpg)  # gives dotplot,  many dots stacked invisibly!
# Change year to categorical i.e. factor
mpg$year = as.factor(mpg$year)
plot(hwy~year,data = mpg)      #  same as this:
boxplot(hwy~year,data = mpg)  #  better
---
title: "Graphs in R"
author: "Ernst Linder"
date: "2019"
output: word_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### Packages
In this presentation we are using the packages:
'MASS', 'ggplot2', 'lubridate', and 'scales'.
Please first install 'ggplot2' and 'lubridate'.  'MASS' is installed automatically with the base installation of R. 'scales' may be installed with 'ggplot2' (not sure).
### Exploring what's in a Data Set
We use the Car fuel economy data from U.S. EPA available in the  package ggplot2
*What are the variables ?*  (Use  'head' and 'tail')
*What are the dimensions ?*
```{r  Exploring Data }
library(ggplot2)
data(mpg)   # Car fuel economy data
head(mpg)   ##  head   gives the first 6 lines of the data
tail(mpg)   ##  tail   gives the last 6 lines of the data
dim(mpg)
```
title: "Graphs in R"
author: "Ernst Linder"
date: "2019"
output: word_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### Packages
In this presentation we are using the packages:
'MASS', 'ggplot2', 'lubridate', and 'scales'.
Please first install 'ggplot2' and 'lubridate'.  'MASS' is installed automatically with the base installation of R. 'scales' may be installed with 'ggplot2' (not sure).
### Exploring what's in a Data Set
We use the Car fuel economy data from U.S. EPA available in the  package ggplot2
*What are the variables ?*  (Use  'head' and 'tail')
*What are the dimensions ?*
```{r  Exploring Data }
library(ggplot2)
data(mpg)   # Car fuel economy data
head(mpg)   ##  head   gives the first 6 lines of the data
tail(mpg)   ##  tail   gives the last 6 lines of the data
dim(mpg)
```
### Summarizing with Tables and Graphs
* What is fl?
* Examine hwy  (highway mileage)
* Histogram
* Frequency Table / Bar Graphs
* Scatterplot
* Boxplot,  Conditioning Plot
```{r Summarizing and Graphing Part 1 }
# What is fl?
table(mpg$fl)
# Highway Miles per gallon
hist(mpg$hwy)
##  better;  use "with", then graph annotations are nicer
attach(mpg)
hist(hwy)
detach(mpg)
par(mfrow=c(1,2))
with(mpg,hist(hwy))
# Write a nice title
with(mpg,hist(hwy,main="Highway Fuel Efficiency in miles/gal ",cex.main = .7,xlab="highway mpg"))
hist(mpg$hwy, main="highway fuel efficiency in miles/gal", xlab="highway mpg")
# Examine data :  categorical Variable 'year'
table(mpg$year)   #  frequency table of categorical variable
barplot(table(mpg$year))
title(" frequency of year")
# Scatterplot:  City versus Highway Mileage
with(mpg,plot(cty,hwy))
# a better way with nicer labels
plot(hwy ~ cty, data = mpg)
title("fuel efficiency in miles/gal",cex=.8)
#  Boxplot
boxplot(mpg$hwy,main = "highway mileage")
# Conditioning on a categorical variable:
plot(hwy~year,data = mpg)  # gives dotplot,  many dots stacked invisibly!
# Change year to categorical i.e. factor
mpg$year = as.factor(mpg$year)
plot(hwy~year,data = mpg)      #  same as this:
boxplot(hwy~year,data = mpg)  #  better
```
#  Boxplot
boxplot(mpg$hwy,main = "highway mileage")
head(mpg)
library(ggplot)
data(mpg)
head(mpg)
tail (mpg)
#What is fl?
table(mpg$fl)
#highway miles per gallon
hist(mpg$hwy)
# using with makes graph annotations cleaner
par(mfrow=c(1,2))
with(mpg,hist(hwy))
#Inserting a title
with(mpg,hist(hwy,main="Highway Fuel Efficiency in miles/gal",cex.main=.7,xlab=highway mpg))
#Inserting a title
with(mpg,hist(hwy,main="Highway Fuel Efficiency in miles/gal",cex.main=.7,xlab="highway mpg"))
boxplot(mpg$hwy,main = "highway mileage")
library(MASS)
data(cars93)
head(cars93)
library(MASS)
data(cars93)
head(cars93)
library(MASS)
data(cars93)
library(cars93)
library(MASS)
data("Cars93")
head(Cars93)
dim(Cars93)
attach(Cars93)
hist(mpg.highway,xlab="miles per us gallon", main="histogram")
hist(MPG.highway,xlab="Miles per US Gallon", main="Histogram")
show_col(hue_pal()(4)) ggplot2_color_codes_level_4_from_scales
setwd("D:/R/phyto-thesis")
library(ggplot2)
#library(tinytex)
library(dplyr)
library(tidyr)
#library(formattable)
library(forcats)
library(tidyverse)
#library(viridis)
library(ggtext)
combch <- read.csv("combinedch.csv" , stringsAsFactors = TRUE)
colnames(combch)<- c("Week", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN")
View(combch)
combch <- read.csv("combinedch.csv" , stringsAsFactors = TRUE)
View(combch)
#Filtering out zeros to get count for co occurance table
combch %>% filter(Alex > 0, abundance > 0)
#Filtering out zeros to get count for co occurance table
cooccur <- combch %>% filter(Alex > 0, abundance > 0)
View(cooccur)
table(cooccur$Station, cooccur$size_class)
table(cooccur$Station, cooccur$size_class, cooccur$Year)
chco <- table(cooccur$Station, cooccur$size_class, cooccur$Year)
#Regression of co ocurrance
install.packages("broom")
#Regression of co ocurrance
install.packages("broom")
install.packages("broom")
install.packages("ggpubr")
library(ggplot2)
library(dplyr)
library(broom)
library(ggpubr)
summary(combch)
#Rule 2 Normality, does dependent variable have a normal distribution
hist(combch$Alex)
as.data.frame.matrix(chco)
table(cooccur$Station, cooccur$size_class, cooccur$Year)
as.data.frame.matrix(chco)
table(cooccur$Station, cooccur$size_class)
setwd("D:/R/phyto-thesis")
#Filtering out zeros to get count for co occurance table
cooccur <- combch %>% filter(Alex > 0, abundance > 0)
combch <- read.csv("combinedch.csv" , stringsAsFactors = TRUE)
#Filtering out zeros to get count for co occurance table
cooccur <- combch %>% filter(Alex > 0, abundance > 0)
library(ggplot2)
#library(tinytex)
library(dplyr)
library(tidyr)
#library(formattable)
library(forcats)
library(tidyverse)
#library(viridis)
library(ggtext)
library(broom)
library(ggpubr)
#Filtering out zeros to get count for co occurance table
cooccur <- combch %>% filter(Alex > 0, abundance > 0)
View(cooccur)
combch <- read.csv("combinedch.csv" , stringsAsFactors = TRUE)
#Filtering out zeros to get count for co occurance table
coocur <- combch %>% filter(Alex > 0, abundance > 0)
#Rule 2 Normality, does dependent variable have a normal distribution FALSE
hist(coocur$Alex)
logco[,c(6,8)] <- log10(coocur[,c(6,8)])
coocur[,c(6,8)] <- log10(coocur[,c(6,8)])
View(coocur)
#Rule 2 Normality, does dependent variable have a normal distribution FALSE
hist(coocur$Alex)
#Filtering out zeros to get count for co occurance table
coocur <- combch %>% filter(Alex > 0, abundance > 0)
View(coocur)
View(coocur)
cor.test(coocur$abundance, coocur$Alex,
method = "spearman")
ggplot(coocur, aes(x = abundance, y = Alex))  +
geom_point(size = 2) +
scale_x_log10(labels = function(x) format(x, scientific = TRUE)) +
scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +
theme_bw() +
labs(x = "Log *Pseudo-nitzschia* Abundance (Cells/l)", y = "Log *Alexandrium* Abundance (Cells/l)") +
theme(axis.title.x = ggtext::element_markdown()) +
theme(axis.title.y = ggtext::element_markdown())
kenres<-cor.test(coocur$abundance,coocur$Alex, method="kendall")
View(kenres)
cor.test(coocur$abundance,coocur$Alex, method="kendall")
View(kenres)
smco <- coocur %>% filter(size_class = Small_PN)
smco <- coocur %>% filter(size_class =+ Small_PN)
smco <- coocur %>% filter(size_class == Small_PN)
smco <- coocur %>% filter(size_class == Small_PN)
smco <- coocur %>% filter(size_class == "Small_PN")
View(smco)
lgco <- coocur %>% filter(size_class == "Large_PN")
View(lgco)
cor.test(smco$abundance,smco$Alex, method="kendall")
#Kendall test running all the data
cor.test(coocur$abundance,coocur$Alex, method="kendall")
cor.test(smco$abundance,smco$Alex, method="kendall")
cor.test(lgco$abundance,lgco$Alex, method="kendall")
#Kendall test running all the data
cor.test(coocur$abundance,coocur$Alex, method="kendall")
#Kendall's tau-b
cor(coocur$abundance, coocur$Alex, method="kendall", use="pairwise")
install.packages("rpud")
library(rpud)
rpucor(coocur$abundance, coocur$Alex, method="kendall", use="pairwise")
KendallTauB(coocur$abundance,coocur$Alex)
install.packages("DescTools")
library(DescTools)
KendallTauB(coocur$abundance,coocur$Alex)
ktball <- KendallTauB(coocur$abundance,coocur$Alex)
View(kenres)
smco %>% filter(size_class == "Small_PM")
smco %>% filter(size_class == "Small_PN")
smco <- coocur %>% filter(size_class == "Small_PN")
ktball <- KendallTauB(coocur$abundance, coocur$Alex, conf.level=0.95)
KendallTauB(coocur$abundance, coocur$Alex, conf.level=0.95)
ktbsm <- KendallTauB(smco$abundance,smco$Alex)
lgco <- coocur %>% filter(size_class == "Large_PN")
ktblg <- KendallTauB(lgco$abundance,lgco$Alex)
ktbsm$p.value
setwd("C:/phyto-thesis")
combch <- read.csv("combinedch.csv" , stringsAsFactors = TRUE)
combch <- read.csv("combinedch.csv" , stringsAsFactors = TRUE)
View(combch)
View(combch)
ggplot(combch, aes(x = abundance, y = Alex))  +
geom_point(size = 2) +
scale_x_log10(labels = function(x) format(x, scientific = TRUE)) +
scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +
theme_bw() +
labs(x = "Log *Pseudo-nitzschia* Abundance (Cells/l)", y = "Log *Alexandrium* Abundance (Cells/l)") +
theme(axis.title.x = ggtext::element_markdown()) +
theme(axis.title.y = ggtext::element_markdown()) +
facet_grid(rows = vars(size_class), cols = vars(Station))
library(ggplot2)
#library(tinytex)
library(dplyr)
library(tidyr)
#library(formattable)
library(forcats)
library(tidyverse)
#library(viridis)
library(ggtext)
ggplot(combch, aes(x = abundance, y = Alex))  +
geom_point(size = 2) +
scale_x_log10(labels = function(x) format(x, scientific = TRUE)) +
scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +
theme_bw() +
labs(x = "Log *Pseudo-nitzschia* Abundance (Cells/l)", y = "Log *Alexandrium* Abundance (Cells/l)") +
theme(axis.title.x = ggtext::element_markdown()) +
theme(axis.title.y = ggtext::element_markdown()) +
facet_grid(rows = vars(size_class), cols = vars(Station))
pal <- c("Alex" = "#39568CFF", "PN" = "#3CBB75FF", "PNSA" = "#440154FF", "PNLA" = "#FDE725FF")
pal <- c("Alex" = "#39568CFF", "PN" = "#3CBB75FF", "PNSA" = "#440154FF", "PNLA" = "#FDE725FF", "NONE" = "black")
