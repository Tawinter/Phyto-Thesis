cml <- read.csv("R_UNH_Pier.csv", stringsAsFactors = TRUE)
colnames(hampton)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN")
colnames(cml)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN",
"Chlorophyl", "PAR", "Temp", "Salinity")
cml$Alex <- as.numeric(cml$Alex)
cml$Large_PN <- as.numeric(cml$Large_PN)
cml$Small_PN <- as.numeric(cml$Small_PN)
hampton$Alex <- as.numeric(hampton$Alex)
hampton$Large_PN <- as.numeric(hampton$Large_PN)
hampton$Small_PN <- as.numeric(hampton$Small_PN)
#Grouping, filtering, and creating a new table with multiple columns and set parameters
cml1 <- cml %>%
group_by(Year) %>%
summarize_at(c("Alex", "Large_PN", "Small_PN"), sum, na.rm = TRUE)
hampton1 <- hampton %>%
group_by(Year) %>%
summarize_at(c("Alex", "Large_PN", "Small_PN"), sum, na.rm = TRUE)
#Changing cml1 and hampton1 to long data
cml1_long <- gather(cml1, Species, Total_Abundance, Alex:Small_PN, factor_key=TRUE)
hampton1_long <- gather(hampton1, Species, Total_Abundance, Alex:Small_PN, factor_key=TRUE)
#Graphing data
ggplot(cml1_long, mapping = aes(x = Year, y = Total_Abundance, shape = Species)) +
geom_point(size = 3) +
scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +
theme_classic() +
labs(x = "Year", y = "Total Abundance (Cells/l)")
ggplot(hampton1_long, mapping = aes(x = Year, y = Total_Abundance, shape = Species)) +
geom_point(size = 3) +
scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +
theme_classic() +
labs(x = "Year", y = "Total Abundance (Cells/l)")
ggplot(cml_month, mapping = aes(x = Month, y = Alex, color = Year)) +
geom_point(aes(color = factor(Year)), size = 3) +
scale_color_manual(values = cols) +
scale_y_log10() +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D")) +
theme_classic() +
labs(x = "Month", y = "Log Total Abundance (Cells/l)")
ggplot(cml_month, mapping = aes(x = Month, y = Large_PN, color = Year)) +
geom_point(aes(color = factor(Year)), size = 3) +
scale_color_manual(values = cols) +
scale_y_log10() +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D")) +
theme_classic() +
labs(x = "Month", y = "Log Total Abundance (Cells/l)")
ggplot(hampton_month, mapping = aes(x = Month, y = Alex, color = Year)) +
geom_point(aes(color = factor(Year)), size = 3) +
scale_color_manual(values = cols) +
scale_y_log10() +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D")) +
theme_classic() +
labs(x = "Month", y = "Log Total Abundance (Cells/l)")
ggplot(cml_month, mapping = aes(x = Month, y = Large_PN, color = Year)) +
geom_point(aes(color = factor(Year)), size = 3) +
scale_color_manual(values = cols) +
scale_y_log10() +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D")) +
theme_classic() +
labs(x = "Month", y = "Log Total Abundance (Cells/l)")
ggplot(hampton_month, mapping = aes(x = Month, y = Large_PN, color = Year)) +
geom_point(aes(color = factor(Year)), size = 3) +
scale_color_manual(values = cols) +
scale_y_log10() +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D")) +
theme_classic() +
labs(x = "Month", y = "Log Total Abundance (Cells/l)")
ggplot(hampton_month, mapping = aes(x = Month, y = Large_PN, color = Year)) +
geom_point(aes(color = factor(Year)), size = 3) +
scale_color_manual(values = cols) +
scale_y_log10() +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D")) +
theme_classic() +
labs(x = "Month", y = "Log Total Abundance (Cells/l)")
ggplot(cml_month, mapping = aes(x = Month, y = Small_PN, color = Year)) +
geom_point(aes(color = factor(Year)), size = 3) +
scale_color_manual(values = cols) +
scale_y_log10() +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D")) +
theme_classic() +
labs(x = "Month", y = "Log Total Abundance (Cells/l)")
ggplot(hampton_month, mapping = aes(x = Month, y = Small_PN, color = Year)) +
geom_point(aes(color = factor(Year)), size = 3) +
scale_color_manual(values = cols) +
scale_y_log10() +
scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9,10,11,12),
labels = c("J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D")) +
theme_classic() +
labs(x = "Month", y = "Log Total Abundance (Cells/l)")
hampton <- read.csv("R_HHHR2.csv" , stringsAsFactors = TRUE)
cml <- read.csv("R_UNH_Pier.csv", stringsAsFactors = TRUE)
colnames(hampton)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN")
colnames(cml)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN",
"Chlorophyl", "PAR", "Temp", "Salinity")
#Filtering out species that have zero in the row
cml_LPN <- filter (cml, Alex > 0, Large_PN > 0)
cml_SPN <- filter (cml, Alex > 0, Small_PN > 0)
hampton_LPN <- filter (hampton, Alex > 0, Large_PN > 0)
hampton_SPN <- filter (hampton, Alex > 0, Small_PN > 0)
#Scatter plots
ggplot(cml_LPN, mapping = aes(x = Large_PN, y = Alex)) +
geom_point() +
theme_classic() +
labs(x = "Large Pseudo-nitzschia Abundance (Cells/l)", y = "Alexandrium Abundance (Cells/l)")
ggplot(cml_SPN, mapping = aes(x = Small_PN, y = Alex)) +
geom_point() +
theme_classic() +
labs(x = "Small Pseudo-nitzschia Abundance (Cells/l)", y = "Alexandrium Abundance (Cells/l)")
ggplot(cml_LPN, mapping = aes(x = Large_PN, y = Alex)) +
geom_point() +
scale_x_log10() +
theme_classic() +
labs(x = "Large Pseudo-nitzschia Abundance (Cells/l)", y = "Alexandrium Abundance (Cells/l)")
ggplot(cml_SPN, mapping = aes(x = Small_PN, y = Alex)) +
geom_point() +
scale_x_log10() +
theme_classic() +
labs(x = "Small Pseudo-nitzschia Abundance (Cells/l)", y = "Alexandrium Abundance (Cells/l)")
ggplot(hampton_LPN, mapping = aes(x = Large_PN, y = Alex)) +
geom_point() +
theme_classic() +
labs(x = "Large Pseudo-nitzschia Abundance (Cells/l)", y = "Alexandrium Abundance (Cells/l)")
View(cml_LPN)
View(cml_SPN)
View(hampton_LPN)
View(hampton_SPN)
ggplot(hampton_SPN, mapping = aes(x = Small_PN, y = Alex)) +
geom_point() +
theme_classic() +
labs(x = "Small Pseudo-nitzschia Abundance (Cells/l)", y = "Alexandrium Abundance (Cells/l)")
ggplot(hampton_LPN, mapping = aes(x = Large_PN, y = Alex)) +
geom_point() +
scale_x_log10() +
theme_classic() +
labs(x = "Large Pseudo-nitzschia Abundance (Cells/l)", y = "Alexandrium Abundance (Cells/l)")
ggplot(hampton_SPN, mapping = aes(x = Small_PN, y = Alex)) +
geom_point() +
scale_x_log10() +
theme_classic() +
labs(x = "Small Pseudo-nitzschia Abundance (Cells/l)", y = "Alexandrium Abundance (Cells/l)")
View(cml_LPN)
hampton <- read.csv("R_HHHR2.csv" , stringsAsFactors = TRUE)
cml <- read.csv("R_UNH_Pier.csv", stringsAsFactors = TRUE)
colnames(hampton)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN")
colnames(cml)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN",
"Chlorophyl", "PAR", "Temp", "Salinity")
size_cml <- cml[ , c("Week", "Date", "Month", "Day", "Year", "Station", "Large_PN",
"Small_PN")]
size_hampton <- hampton[ , c("Week", "Date", "Month", "Day", "Year", "Station",
"Large_PN", "Small_PN")]
#Get the sum per month ad create new column
size_cml_1 <- size_cml %>%
group_by(Year, Month) %>%
summarize_at(c("Large_PN", "Small_PN"), sum, na.rm = TRUE)
size_hampton_1 <- size_hampton %>%
group_by(Year, Month) %>%
summarize_at(c("Large_PN", "Small_PN"), sum, na.rm = TRUE)
#Turn into long data
size_cml_1 <- gather(size_cml_1, Class, Sum_Abundance, Large_PN:Small_PN, factor_key=TRUE)
size_hampton_1 <- gather(size_hampton_1, Class, Sum_Abundance, Large_PN:Small_PN,
factor_key=TRUE)
#Convert month number to month 3 letter abbreviation
mymonths <- c("Jan","Feb","Mar",
"Apr","May","Jun",
"Jul","Aug","Sep",
"Oct","Nov","Dec")
size_cml_1$MoAb <- mymonths[ size_cml_1$Month ]
size_hampton_1$MoAb <- mymonths[ size_hampton_1$Month ]
size_cml_1$MY <- paste(size_cml_1$MoAb, "-", size_cml_1$Year)
size_hampton_1$MY <- paste(size_hampton_1$MoAb, "-", size_hampton_1$Year)
ggplot(size_cml_1[which(size_cml_1$Sum_Abundance > 0.0),], aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
library(forcats)
ggplot(size_cml_1[which(size_cml_1$Sum_Abundance > 0.0),], aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1[which(size_hampton_1$Sum_Abundance > 0.0),], aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
View(size_hampton_1)
ggplot(size_hampton_1[which(size_hampton_1$Sum_Abundance > 0.0),], aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1[which(size_cml_1$Sum_Abundance > 0.0),], aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1[which(size_hampton_1$Sum_Abundance > 0.0),], aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1[which(size_cml_1$Sum_Abundance > 0.0),], aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1[which(size_hampton_1$Sum_Abundance > 0.0),], aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
hampton <- read.csv("R_HHHR2.csv" , stringsAsFactors = TRUE)
cml <- read.csv("R_UNH_Pier.csv", stringsAsFactors = TRUE)
colnames(hampton)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN")
colnames(cml)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN",
"Chlorophyl", "PAR", "Temp", "Salinity")
size_cml <- cml[ , c("Week", "Date", "Month", "Day", "Year", "Station", "Large_PN",
"Small_PN")]
size_hampton <- hampton[ , c("Week", "Date", "Month", "Day", "Year", "Station",
"Large_PN", "Small_PN")]
#Get the sum per month and create new column
size_cml_1 <- size_cml %>%
group_by(Year, Month) %>%
summarize_at(c("Large_PN", "Small_PN"), sum, na.rm = TRUE)
size_hampton_1 <- size_hampton %>%
group_by(Year, Month) %>%
summarize_at(c("Large_PN", "Small_PN"), sum, na.rm = TRUE)
#Turn into long data
size_cml_1 <- gather(size_cml_1, Class, Sum_Abundance, Large_PN:Small_PN, factor_key=TRUE)
size_hampton_1 <- gather(size_hampton_1, Class, Sum_Abundance, Large_PN:Small_PN,
factor_key=TRUE)
#Convert month number to month 3 letter abbreviation
mymonths <- c("Jan","Feb","Mar",
"Apr","May","Jun",
"Jul","Aug","Sep",
"Oct","Nov","Dec")
size_cml_1$MoAb <- mymonths[ size_cml_1$Month ]
size_hampton_1$MoAb <- mymonths[ size_hampton_1$Month ]
size_cml_1$MY <- paste(size_cml_1$MoAb, "-", size_cml_1$Year)
size_cml_1$MY <- paste(size_cml_1$MoAb, "-", size_cml_1$Year)
size_hampton_1$MY <- paste(size_hampton_1$MoAb, "-", size_hampton_1$Year)
View(size_cml_1)
#Remove rows that have a zero
size_cml_1 <- filter (size_cml_1, Sum_Abundance > 0.0)
size_hampton_1 <- filter (size_hampton_1, Sum_Abundance > 0.0)
ggplot(size_cml_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill", width = 0.5) +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill", width = 0.5) +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
hampton <- read.csv("R_HHHR2.csv" , stringsAsFactors = TRUE)
cml <- read.csv("R_UNH_Pier.csv", stringsAsFactors = TRUE)
View(cml)
View(hampton)
colnames(hampton)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN")
colnames(cml)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN",
"Chlorophyl", "PAR", "Temp", "Salinity")
size_cml <- cml[ , c("Week", "Date", "Month", "Day", "Year", "Station", "Large_PN",
"Small_PN")]
size_hampton <- hampton[ , c("Week", "Date", "Month", "Day", "Year", "Station",
"Large_PN", "Small_PN")]
View(size_cml)
View(size_hampton)
#Get the sum per month and create new column
size_cml_1 <- size_cml %>%
group_by(Year, Month) %>%
summarize_at(c("Large_PN", "Small_PN"), sum, na.rm = TRUE)
View(size_cml_1)
size_hampton_1 <- size_hampton %>%
group_by(Year, Month) %>%
summarize_at(c("Large_PN", "Small_PN"), sum, na.rm = TRUE)
View(size_hampton_1)
#Turn into long data
size_cml_1 <- gather(size_cml_1, Class, Sum_Abundance, Large_PN:Small_PN, factor_key=TRUE)
size_hampton_1 <- gather(size_hampton_1, Class, Sum_Abundance, Large_PN:Small_PN,
factor_key=TRUE)
#Convert month number to month 3 letter abbreviation
mymonths <- c("Jan","Feb","Mar",
"Apr","May","Jun",
"Jul","Aug","Sep",
"Oct","Nov","Dec")
size_cml_1$MoAb <- mymonths[ size_cml_1$Month ]
size_hampton_1$MoAb <- mymonths[ size_hampton_1$Month ]
size_cml_1$MY <- paste(size_cml_1$MoAb, "-", size_cml_1$Year)
size_hampton_1$MY <- paste(size_hampton_1$MoAb, "-", size_hampton_1$Year)
#Remove rows that have a zero
size_cml_1 <- filter (size_cml_1, Sum_Abundance > 0.0)
size_hampton_1 <- filter (size_hampton_1, Sum_Abundance > 0.0)
ggplot(size_cml_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1, aes(x = MY, y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1, aes(x = MY, y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_x_discrete(limits = month.abb)
ggplot(size_cml_1, aes(x = MY, y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_x_discrete(limits = month.abb) +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1, aes(x = MY, y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1, aes(x = MY, y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1,aes(x = MY, y = Sum_Abundance,fill = Class)) +
geom_bar(stat = "identity",
position = "stack") +
facet_grid(~ facet)
ggplot(size_cml_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
hampton <- read.csv("R_HHHR2.csv" , stringsAsFactors = TRUE)
cml <- read.csv("R_UNH_Pier.csv", stringsAsFactors = TRUE)
colnames(hampton)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN")
colnames(cml)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN",
"Chlorophyl", "PAR", "Temp", "Salinity")
size_cml <- cml[ , c("Week", "Date", "Month", "Day", "Year", "Station", "Large_PN",
"Small_PN")]
size_hampton <- hampton[ , c("Week", "Date", "Month", "Day", "Year", "Station",
"Large_PN", "Small_PN")]
#Get the sum per month and create new column
size_cml_1 <- size_cml %>%
group_by(Year, Month) %>%
summarize_at(c("Large_PN", "Small_PN"), sum, na.rm = TRUE)
size_hampton_1 <- size_hampton %>%
group_by(Year, Month) %>%
summarize_at(c("Large_PN", "Small_PN"), sum, na.rm = TRUE)
#Turn into long data
size_cml_1 <- gather(size_cml_1, Class, Sum_Abundance, Large_PN:Small_PN, factor_key=TRUE)
size_hampton_1 <- gather(size_hampton_1, Class, Sum_Abundance, Large_PN:Small_PN,
factor_key=TRUE)
#Convert month number to month 3 letter abbreviation
mymonths <- c("Jan","Feb","Mar",
"Apr","May","Jun",
"Jul","Aug","Sep",
"Oct","Nov","Dec")
size_cml_1$MoAb <- mymonths[ size_cml_1$Month ]
size_hampton_1$MoAb <- mymonths[ size_hampton_1$Month ]
.size_cml_1$MY <- paste(size_cml_1$MoAb, "-", size_cml_1$Year)
size_cml_1$MY <- paste(size_cml_1$MoAb, "-", size_cml_1$Year)
size_hampton_1$MY <- paste(size_hampton_1$MoAb, "-", size_hampton_1$Year)
ggplot(size_cml_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1, aes(x = MY, y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1, aes(x = fct_order(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_cml_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
ggplot(size_hampton_1, aes(x = fct_inorder(MY), y = Sum_Abundance, fill = Class)) +
geom_col(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = "Pastel1") +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Month", y = "Percentage of Abundance")
