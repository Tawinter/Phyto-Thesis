library(ggplot2)
library(tinytex)
library(dplyr)
library(tidyr)
library(formattable)
library(forcats)
library(tidyverse)
library(viridis)
library(ggtext)
library(hexbin)
setwd("C:/Users/twint/Desktop/phyto-thesis")
#How are the populations changing over time?
hampton <- read.csv("R_HHHR2.csv" , stringsAsFactors = TRUE)
cml <- read.csv("R_UNH_Pier.csv", stringsAsFactors = TRUE)
colnames(hampton)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN")
colnames(cml)<- c("Week", "Date", "Month", "Day", "Year", "Station", "Alex", "Large_PN", "Small_PN", "Temp", "Salinity")
cml_max <- cml %>%
group_by(Year) %>%
summarize_at(c("Alex", "Large_PN", "Small_PN"), max, na.rm = TRUE)
hampton_max <- hampton %>%
group_by(Year) %>%
summarize_at(c("Alex", "Large_PN", "Small_PN"), max, na.rm = TRUE)
View(cml_max)
View(cml_max)
maxch <- read.csv("CML_Max.csv", stringsAsFactors = TRUE)
maxch_1 <- gather(maxch, species, max, Alex, Large_PN, Small_PN)
View(maxch_1)
ggplot(maxch_1, aes(x = Year, y = max))  +
geom_point(aes(fill = factor(species)), size = 3, shape = 21) +
scale_fill_manual(values = c("#440154FF", "#1F968BFF", "#FDE725FF")) +
scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +
theme_bw() +
labs(x = "Year", y = "Log Annual Max (Cells/l)", fill = "Species") +
facet_grid(cols = vars(Location))
maxch <- read.csv("maxch.csv", stringsAsFactors = TRUE)
maxch_1 <- gather(maxch, species, max, Alex, Large_PN, Small_PN)
ggplot(maxch_1, aes(x = Year, y = max))  +
geom_point(aes(fill = factor(species)), size = 3, shape = 21) +
scale_fill_manual(values = c("#440154FF", "#1F968BFF", "#FDE725FF")) +
scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +
theme_bw() +
labs(x = "Year", y = "Log Annual Max (Cells/l)", fill = "Species") +
facet_grid(cols = vars(Location))
ggplot(maxch_1, aes(x = Year, y = max))  +
geom_point(aes(fill = factor(species)), size = 3, shape = 21) +
scale_fill_manual(values = c("#440154FF", "#1F968BFF", "#FDE725FF")) +
scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +
theme_bw() +
labs(x = "Year", y = "Log Max Abundance (Cells/l)", fill = "Species") +
facet_grid(cols = vars(Location))
##Poster Graph Nitrogen:Phosphorus
nutlong <- read.csv("CML_Nut_Long.csv" , stringsAsFactors = TRUE)
nutlong <- nutlong %>%
separate(fct_inorder.MY., sep="-", into = c("month", "year"))
nutlong <- transform(nutlong,
year = as.numeric(year))
ggplot(nutlong[which(nutlong$abundance.avg>0),], aes(x = phosphorus, y = abundance.avg)) +
geom_point(aes(fill = factor(year)), shape = 21, size = 3) +
scale_x_continuous(limits = c(0.005, 0.045)) +
scale_fill_manual(values = c("#440154FF", "#39568CFF", "#1F968BFF",
"#3CBB75FF", "#95D840FF", "#FDE725FF")) +
scale_y_log10(labels = function(x) format(x, scientific = TRUE)) +
theme_bw() +
labs (x = "Phosphorus (mg/l)", y = "Average Abundance (Cells/l)", fill = "Year") +
facet_grid(rows = vars(species.avg))
